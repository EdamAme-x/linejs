<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LINE-Deno-Client ・ API Test</title>
</head>

<body>
    <style>
        .out {
            max-width: 98%;
            width: 98%;
            height: 90vh;
        }
        textarea {
            max-width: 98%;
            width: 98%;
            height: 100px;
        }
        input {
            max-width: 98%;
            width: 98%;
        }
    </style>

    <h3>Account</h3>
    <p>authToken</p>
    <input type="text" id="auth" value="eyJ...">
    <p>device-name</p>
    <input type="text" id="device" value="DESKTOPWIN">
    <p>Login</p>
    <button type="button" onclick="create()">Login</button>
    <h3>ツール</h3>
    <h5>ticket→squareMid</h5>
    <p>ticket:<input type="text" id="ticket" value="DESKTOPWIN"></p>
    <button type="button" onclick="ticket()">Run</button>
    <p>response</p>
    <textarea id="ticketRes"></textarea>
    
    <h5>参加オプ一覧</h5>
    <button type="button" onclick="joined()">Run</button>
    <p>response</p>
    <textarea id="joinedRes"></textarea>

    <h5>再参加禁止リスト取得</h5>
    <p>sid:<input type="text" id="bansid" value="DESKTOPWIN"></p>
    <button type="button" onclick="banlist()">Run</button>
    <p>response</p>
    <textarea id="banlistRes"></textarea>
    
    <script src="./script.js"></script>
    <script>
        if (localStorage.getItem("auth")) {
            document.getElementById("auth").value = localStorage.getItem("auth")
        } if (localStorage.getItem("device")) {
            document.getElementById("device").value = localStorage.getItem("device")
        } if (localStorage.getItem("inV")) {
            document.getElementById("inV").value = localStorage.getItem("inV")
        }
        var Account;
        const create = async () => {
            Account = new LineTCompactSocket(document.getElementById("path").value, document.getElementById("auth").value, document.getElementById("device").value)
        }
        const main = async () => {
            if (Account) {
            localStorage.setItem("auth",document.getElementById("auth").value)
            localStorage.setItem("device",document.getElementById("device").value)
            localStorage.setItem("inV",document.getElementById("inV").value)
                let v = JSON.parse(document.getElementById("inV").value)
                let n = document.getElementById("inN").value
                let tjson = await Account.postRequestAndGetResponse(v, n)
                document.getElementById("out").value = JSON.stringify(tjson, null, 2)
            } else {
                alert("click [Login] first")
            }
        }
    </script>
</body>
</html>
