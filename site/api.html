<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LINE-Deno-Client ãƒ» API Test</title>
</head>

<body>
    <style>
        .out {
            max-width: 98%;
            width: 98%;
            height: 90vh;
        }

        textarea {
            max-width: 98%;
            width: 98%;
            height: 100px;
        }
        input {
            max-width: 98%;
            width: 98%;
        }
    </style>
    <h3>Account</h3>
    <p>authToken</p>
    <input type="text" id="auth" value="eyJ...(authToken)">
    <p>device-name</p>
    <input type="text" id="device" value="DESKTOPWIN">
    <p>PATH</p>
    <input type="text" id="path" value="/SQ1">
    <p>create socket</p>
    <button type="button" onclick="create()">create</button>
    <h2>&lt;-</h2>
    <h3>Request</h3>
    <p>METHOD_NAME</p>
    <input type="text" id="inN" value="fetchMyEvents">
    <p>params</p>
    <textarea id="inV">
{
    "limit": 100
}
    </textarea>
    <button type="button" onclick="main()">POST</button>
    <h2>-&gt;</h2>
    <h3>Response</h3>
    <textarea class="out" id="out"></textarea>
    <script src="./script.js"></script>
    <script>
        if (localStorage.getItem("auth")) {
            document.getElementById("auth").value = localStorage.getItem("auth")
        } if (localStorage.getItem("device")) {
            document.getElementById("device").value = localStorage.getItem("device")
        } if (localStorage.getItem("inV")) {
            document.getElementById("inV").value = localStorage.getItem("inV")
        }
        var Account;
        const create = async () => {
            Account = new LineTCompactSocket(document.getElementById("path").value, document.getElementById("auth").value, document.getElementById("device").value)
        }
        const main = async () => {
            if (Account) {
            localStorage.setItem("auth",document.getElementById("auth").value)
            localStorage.setItem("device",document.getElementById("device").value)
            localStorage.setItem("inV",document.getElementById("inV").value)
                let v = JSON.parse(document.getElementById("inV").value)
                let n = document.getElementById("inN").value
                let tjson = await Account.postRequestAndGetResponse(v, n)
                document.getElementById("out").value = JSON.stringify(tjson, null, 2)
            } else {
                alert("click [create] first")
            }
        }
    </script>
</body>

</html>